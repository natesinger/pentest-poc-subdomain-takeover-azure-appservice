/* native imports */
import { createRoot } from 'react-dom/client';

/* module imports*/
import Background from '@/background/background';

/* style imports */
import './styles/formatting.scss';
import './root.scss';


/* create the module */
const rootElement = document.getElementById('root');

const App = () => {
  const compromisedDomain = "domain" // like meddra.org
  const compromisedSubdomain = "subdomain" // like tmlab
  const compromisedHostname = compromisedSubdomain + "." + compromisedDomain;
  const internalHostname = "internalhostname.azuresites.com"; // like eusmeddratmlabd.azuresites.com

  return (
    <Background>
      <div className="header non-selectable">
        <p className="ace">Advanced Cyber Effects <br/>(ACE Group)</p>
        <div className="warning">
          <img src="/img/warning.png" />
          <p className="notice">Notice of compromise!</p>
        </div>
      </div>

      <div className="body">
        <div className="dangle-message">
          This domain, <i>{compromisedDomain}</i>, has a DNS misconfiguration and is dangling the CNAME record <i>{compromisedHostname}</i>. The ACE group has registered an Azure AppService to demonstrate proof of compromise (POC) and to prevent a malicous actor from doing more nefarious things like bypassing CORS controls on a different, more major resource, like the main site.<br/><br/>This protection will remain in place for 30 days following assessment report delivery.<br/><br/> To reclaim this record from Azure within that 30 day window, you will need to work directly with the ACE group. If you instead, no longer care about this record, you may update the DNS configuration for <i>{compromisedHostname}</i> to point to something other than <i>{internalHostname}</i>. It's critical that unused records are cleaned up immediately to prevent this from occuring again in the future.<br/><br/>For additional information, refer to the assessment report provided to you by the ACE group. To learn more about this vulnerability and the impact of subdomain takeover, please refer to <a href="https://learn.microsoft.com/en-us/azure/security/fundamentals/subdomain-takeover">this</a> MSDN reference.
        </div>
      </div>
    </Background>
  );
};

/* inject the module into the html */
if (rootElement) {
    const root = createRoot(rootElement);
    root.render(<App />);
} else {
    console.error('Target element \'root\' not found!');
}
